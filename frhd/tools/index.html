<!DOCTYPE html>
<html>
    <head>
        <title>Tools - FRHD | Calculamatrise</title>
        <link rel="stylesheet" href="/style.css">
        <script type="module" src="/bootstrap.js"></script>
    </head>
    <body>
        <div class="content">
            <div id="container">
                <canvas id="view"></canvas>
                <div class="ui top-left">
                    <button class="primary nav" onclick="this.innerText = `${(document.querySelector('#toolbar').style.display = document.querySelector('#toolbar').style.display === 'grid' ? 'none' : 'grid') === 'grid' ? 'Hide' : 'Show'} Toolbar`;">Show Toolbar</button>
                    <div id="toolbar">
                        <button onclick="window.canvas.tools.select('line');">Line</button>
                        <button onclick="window.canvas.tools.select('brush');">Brush</button>
                        <button onclick="window.canvas.tools.select('curve');">Curve</button>
                        <button onclick="window.canvas.tools.select('circle');">Circle</button>
                        <button onclick="window.canvas.tools.select('rectangle');">Rectangle</button>
                        <button onclick="window.canvas.tools.select('eraser');">Eraser</button>
                        <button onclick="window.canvas.tools.select('camera');">Camera</button>
                        <button onclick="window.canvas.tools.select('select');">Select</button>
                        <button onclick="
                            this.parentElement.querySelector('#toolbar #advanced-tools').style.display = this.parentElement.querySelector('#toolbar #advanced-tools').style.display === 'flex' ? 'none' : 'flex',
                            this.parentElement.querySelector('#toolbar #advanced-tools').scrollIntoView({ behavior: 'smooth' }),
                            this.innerText = this.innerText === 'Show Advanced Tools' ? 'Hide Advanced Tools' : 'Show Advanced Tools'
                        ">Show Advanced Tools</button>
                        <div id="advanced-tools">
                            <button onclick="window.canvas.tools.select('dynamic_circle');">Dynamic Circle</button>
                            <button class="option ripple rainbow" id="randomColors" onclick="
                                if (JSON.parse(sessionStorage.getItem('randomColors'))) {
                                    this.innerText = 'Enable Random Colours';
                                    
                                    sessionStorage.setItem('randomColors', false);

                                    return;
                                }

                                this.innerText = 'Disable Random Colours';

                                sessionStorage.setItem('randomColors', true);
                            ">
                                Enable Random Colours
                            </button>
                        </div>
                    </div>
                </div>
                <div class="ui bottom-left">
                    <button class="primary nav" onclick="window.canvas.color = 'primary';">Primary Colour</button>
                    <button class="primary nav" onclick="window.canvas.color = 'secondary';">Secondary Colour</button>
                </div>
                <div class="ui top-right">
                    <button class="primary nav" onclick="document.querySelector('#layers').style.display = document.querySelector('#layers').style.display === 'flex' ? 'none' : 'flex';" disabled>Layers</button>
                    <button class="primary nav" onclick="document.querySelector('#settings').style.display = document.querySelector('#settings').style.display === 'flex' ? 'none' : 'flex';">Settings</button>
                </div>
                <div class="ui bottom-right">
                    <button class="primary nav" id="patch-notes" disabled>Patch Notes</button>
                </div>
                <!-- Layers Overlay -->
                <div id="layers">
                    <button onclick="window.canvas.layers.create(), window.canvas.layerDepth = window.canvas.layerDepth + 1;" style="position: absolute;">New Layer</button>
                    <div id="layer-container"></div>
                </div>
                <!-- Settings Overlay -->
                <div id="settings" style="display: none;">
                    <input type="file" id="import" accept="text/plain" style="display: none;" onchange="
                        this.classList.add('loading');
                        this.files[0].text().then((text) => {
                            if (this.classList.contains('loading')) {
                                this.classList.remove('loading');
                            }

                            window.canvas.import(text);
                        });
                    ">
                    <label for="import" class="button primary" style="text-align: center; line-height: 350%; font-size: calc(40px / 3);">Import Canvas</label>
                    <button onclick="
                        const date = new Date(new Date().setHours(new Date().getHours() - new Date().getTimezoneOffset() / 60)).toISOString().split(/t/i);
                        const link = document.createElement('a');
                        const file = new Blob([
                            window.canvas.toString()
                        ], {
                            type: 'text/plain'
                        });
                        link.href = window.URL.createObjectURL(file);
                        link.download = 'frhd_canvas-' + date[0] + '_' + date[1].replace(/\..+/, '').replace(/:/g, '-');
                        link.dispatchEvent(new MouseEvent('click'));
                    ">Export Canvas</button>
                </div>
            </div>
        </div>
        <link rel="stylesheet" href="style.css">
        <script type="module" src="bootstrap.js"></script>
    </body>
</html>
