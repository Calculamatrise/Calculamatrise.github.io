<!DOCTYPE html>
<html>
    <head>
        <title>Track Combiner</title>
        <link rel="icon" href="/images/icons/icon_512.png">
        <link href="/style.css" rel="stylesheet">
        <link href="./style.css" rel="stylesheet">
        <script async src="/script.js"></script>
    </head>
    <body>
        <header></header>
        <div id=contain>
            <h1 class="title">Track Combiner</h1>
            <input type="button" value="Run" onclick="run()" class="button">
            <input type="button" value="Copy" onclick="copy()" class="button">
            <input type="button" value="Add Track" onclick="add()" class="button">
            <br><br>
            <textarea id="input1" spellcheck="false" placeholder="Track 1"></textarea>
            <textarea id="input2" spellcheck="false" placeholder="Track 2"></textarea>
            <div id="div0"></div>
            <textarea type="text" id="output" placeholder="Combined Track" readonly></textarea>
        </div>
        <script type="text/javascript">
            this.output = document.getElementById("output");
            this.inputs = [
                document.getElementById("input1"),
                document.getElementById("input2")
            ];
            this.black = "";
            this.grey = "";
            this.powerups = "";

            function add() {
            var e = document.createElement("textarea");
            e.id = inputs.length + 1;
            e.rows = "auto";
            e.spellcheck = "false";
            e.placeholder = "Track " + (inputs.length + 1);
            inputs.push(e);
            document.getElementById("div0").appendChild(e);
            }

            function run() {
            inputs.forEach(i => {
                black += (i.value.split("#")[0] ? i.value.split("#")[0] : "") + (i.value.split("#")[0] ? "," : "")
                grey += (i.value.split("#")[1] ? i.value.split("#")[1] : "") + (i.value.split("#")[1] ? "," : "")
                powerups += (i.value.split("#")[2] ? i.value.split("#")[2] : "") + (i.value.split("#")[2] ? "," : "")
            });
            this.combined = (black.endsWith(",") ? black.slice(0,-1) : black) + "#" + (grey.endsWith(",") ? grey.slice(0,-1) : grey) + "#" + (powerups.endsWith(",") ? powerups.slice(0,-1) : powerups);
            output.value = combined;
            output.select();
            }

            function copy() {
            output.select();
                document.execCommand('copy');
            }

            input1.addEventListener('click',function() {
                input1.select();
            });

            input2.addEventListener('click',function() {
                input2.select();
            });

            output.addEventListener('click',function() {
                output.select();
            });

            window.addEventListener('keydown',function(e) {
                var key = e.keyCode || e.which;
                if (key == 13) run();
                if (key == 67) copy();
            });
        </script>
        <footer></footer>
    </body>
</html>
